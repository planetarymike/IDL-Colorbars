from matplotlib.colors import LinearSegmentedColormap
from numpy import nan, inf
cm_data = [[0.000019872508023912684, 0.000019586801788918958, 0.000019529289536969018],
[0.00030564987556982532, 0.00035848594407786002, 0.00031031114596703156],
[0.00083642946066499527, 0.00104518, 0.00086111361890620498],
[0.0015624539818254483, 0.0020495995987783872, 0.0016271452277467741],
[0.0024544958798220213, 0.0033586496617977954, 0.0025832260770535294],
[0.0034913733936842530, 0.0049651868691152510, 0.0037117515198833374],
[0.0046562517535144385, 0.0068650942917121175, 0.0049991836306123834],
[0.0059350173617806132, 0.0090560611070764647, 0.0064345215339350901],
[0.0073154172649676271, 0.011536964786630816, 0.0080084964726655512],
[0.0087865492618252761, 0.0143075, 0.0097130969249212672],
[0.010338535685245063, 0.017368046212686741, 0.0115413],
[0.011962302758228177, 0.020719347204098119, 0.013486695640201933],
[0.013649424950927377, 0.024362585264449815, 0.0155437],
[0.015392011545238012, 0.028299221025334657, 0.017707033708764045],
[0.0171826, 0.032530956959276033, 0.019972],
[0.019014200165761566, 0.037059696147064912, 0.022334054202443804],
[0.020880026032524226, 0.041848962519132234, 0.024789206569984155],
[0.022773674161094108, 0.046624355309497399, 0.0273336],
[0.024689, 0.051361574890543112, 0.029963639071290585],
[0.026620030895548211, 0.0560642, 0.032675986057673898],
[0.0285611, 0.060735370934443734, 0.035467483057406310],
[0.030506728139316791, 0.065377863057746399, 0.038335164508199231],
[0.032451563293972446, 0.069994139776978215, 0.041257546850969447],
[0.034390484179887028, 0.074586399521080787, 0.044124094450044150],
[0.036318526255177827, 0.0791566, 0.046940296990559106],
[0.038230888054765204, 0.083706550981410249, 0.049708562507164815],
[0.040122925910918025, 0.088237815072703729, 0.052431112449351218],
[0.041947773489954883, 0.092751853474284302, 0.055110005944871483],
[0.0436939, 0.097249981576091327, 0.057747160333052584],
[0.045367352507509846, 0.10173339657613381, 0.060344368654872520],
[0.046969079370632348, 0.10620319042434462, 0.062903314640833569],
[0.048500104985580834, 0.11066036093435283, 0.065425585626554983],
[0.049961311522107678, 0.11510582137293226, 0.067912683740518454],
[0.051353495506639195, 0.11954, 0.070366035642010688],
[0.052677377136450577, 0.12396489119814058, 0.072787001035305582],
[0.053933608571538415, 0.12837997404743207, 0.075176880145066877],
[0.0551228, 0.13278630566415103, 0.077536920305279283],
[0.056245433182623143, 0.13718448223310695, 0.079868321787843838],
[0.057302053884136554, 0.14157505213665325, 0.082172242975856152],
[0.058293091135852453, 0.14595851982196925, 0.084449804969450259],
[0.059218955567988084, 0.15033534924888692, 0.086702095698098697],
[0.060080025593264329, 0.15470596697365124, 0.088930173601773327],
[0.0608767, 0.15907076491557284, 0.091135070933885925],
[0.061609161942135927, 0.16343010284654860, 0.0933178],
[0.062277863691646500, 0.16778431063762520, 0.095479339488294707],
[0.062883050013534419, 0.17213369029192130, 0.097620669572355018],
[0.063425002396841096, 0.17647851778916271, 0.099742741402093993],
[0.063903994871902459, 0.18081904476364574, 0.10184649541991275],
[0.064320297893328327, 0.18515550003454728, 0.103933],
[0.064674182267532715, 0.18948809100503480, 0.106003],
[0.064965923166428102, 0.19381700494452656, 0.10805708167501935],
[0.065195804269851471, 0.19814241016665907, 0.11009674833826055],
[0.065364122080927761, 0.202464, 0.11212264659746557],
[0.065471190461028478, 0.20678327935905638, 0.11413566510038878],
[0.065517345433980828, 0.21109899453052516, 0.11613668794938470],
[0.065502950313113428, 0.21541170517167729, 0.118127],
[0.065428401209368187, 0.21972149953822528, 0.12010626552118475],
[0.065294132984163478, 0.22402845234122370, 0.12207657313846501],
[0.065100625717156552, 0.22833262544042321, 0.12403839220763990],
[0.0648484, 0.23263406849277429, 0.12599259548223840],
[0.064538083506599481, 0.23693281956029633, 0.12794005516437262],
[0.064170301841292410, 0.24122890568108346, 0.12988164331466706],
[0.0637458, 0.24552234340683149, 0.13181823220038216],
[0.063265421897224755, 0.24981313930992655, 0.13375069458500208],
[0.062730077707859905, 0.25410129046282926, 0.13567990396225738],
[0.0621408, 0.25838678489222350, 0.137607],
[0.061498792962324932, 0.26266960201015183, 0.13953206235732035],
[0.0608053, 0.26694971302415532, 0.14145676339442983],
[0.060061886630366330, 0.27122708132823575, 0.14338171558200072],
[0.059270118481438351, 0.27550166287629635, 0.14530779780735334],
[0.058431874358821668, 0.27977340653955673, 0.14723589006210061],
[0.057549231199773156, 0.28404225444930820, 0.14916687335209797],
[0.056624518882797688, 0.28830814232624991, 0.15110162956866713],
[0.055660350071405164, 0.292571, 0.15304104132272992],
[0.054659653165172940, 0.29683075070253862, 0.15498599174344813],
[0.053625708533117967, 0.30108731338835504, 0.15693736424293547],
[0.052562188145737758, 0.30534060099576421, 0.15889604224859247],
[0.051473198630479118, 0.30959052173657548, 0.160863],
[0.050363327640464896, 0.31383697916298620, 0.16283884674414858],
[0.049237693234739373, 0.31807987242964952, 0.16482473733386724],
[0.048101995706248839, 0.322319, 0.16682146089215996],
[0.046962570944301209, 0.32655454264064981, 0.16882989588289654],
[0.045826443966575987, 0.33078609817460097, 0.17085091858614829],
[0.044701380688041144, 0.33501364720999832, 0.17288540264757465],
[0.043595935304940332, 0.33923707062858632, 0.17493421860812158],
[0.042519489867937667, 0.34345624636401623, 0.17699823341571624],
[0.041482281728066443, 0.34767104962710743, 0.17907830992067220],
[0.040495413622471367, 0.35188135312742763, 0.181175],
[0.039561614421320876, 0.35608702729148611, 0.18329],
[0.038714069053576987, 0.36028794047782159, 0.18542346566848605],
[0.037963943628756547, 0.36448395918922649, 0.187576],
[0.037321898481816371, 0.36867494828234165, 0.18974946440857718],
[0.036798908361140449, 0.37286077117482719, 0.19194373461033790],
[0.036406261317502270, 0.37704129005029691, 0.19415994673051148],
[0.036155557334911825, 0.38121636606119413, 0.19639891129817105],
[0.036058706700476041, 0.38538585952975302, 0.19866142976154749],
[0.036127928110346007, 0.38955, 0.20094829391801894],
[0.036375746509327955, 0.39370753717130036, 0.20326028534731289],
[0.036814990661992772, 0.39785943962239245, 0.20559817484962040],
[0.037458790453390636, 0.40200519647796901, 0.20796272189027193],
[0.038320573917840550, 0.40614466686592948, 0.21035467405258584],
[0.039414063994700731, 0.41027771025655635, 0.21277476650043742],
[0.040747503762368555, 0.41440418665329332, 0.21522372145203711],
[0.0422955, 0.41852395678236892, 0.21770224766634361],
[0.044066512460080663, 0.42263688228132423, 0.22021103994345564],
[0.046057511258323212, 0.42674282588646850, 0.22275077864025816],
[0.048263801435925561, 0.43084165161930088, 0.22532212920250494],
[0.050679340509667568, 0.43493322497190850, 0.22792574171443997],
[0.053297024985427426, 0.43901741309135922, 0.23056225046696666],
[0.056108978127367253, 0.44309408496308811, 0.23323227354527903],
[0.059106816924710141, 0.44716311159327554, 0.23593641243677566],
[0.062281888320337188, 0.45122436619020562, 0.23867525165997711],
[0.065625469328904285, 0.45527772434459085, 0.24144935841507276],
[0.069128929510279186, 0.45932306420883001, 0.24425928225662252],
[0.072783857147392689, 0.46336026667517821, 0.24710555478884100],
[0.076582152391342528, 0.46738921555278862, 0.24998868938379770],
[0.0805161, 0.47140979774358355, 0.252909],
[0.084578368283833194, 0.47542190341690355, 0.25586750556090682],
[0.088762113222907890, 0.47942542618288636, 0.25886412051522373],
[0.093060901491256232, 0.48342026326451820, 0.26189946387596419],
[0.0974687, 0.48740631566827813, 0.26497395444115807],
[0.10198, 0.49138348835333162, 0.26808799157422930],
[0.10658976840564738, 0.49535169039917387, 0.27124195508438337],
[0.11129301763435465, 0.49931083517166203, 0.27443620512945627],
[0.116085, 0.50326084048734687, 0.27767108214084041],
[0.12096290013078134, 0.50720162877601260, 0.28094690677004824],
[0.12592168021117184, 0.51113312724134352, 0.28426397985642860],
[0.13095827177408775, 0.51505526801961299, 0.28762258241549754],
[0.13606944355807823, 0.51896798833630042, 0.29102297564731988],
[0.14125220067153280, 0.52287123066053121, 0.29446540096433521],
[0.14650376355054112, 0.52676494285723730, 0.29795008003799822],
[0.15182154844055209, 0.53064907833692387, 0.30147721486358220],
[0.15720314940710206, 0.53452359620293488, 0.30504698784248108],
[0.16264632183995137, 0.53838846139609842, 0.30866],
[0.16814896738777182, 0.54224364483663778, 0.31231508050724244],
[0.17370912024362714, 0.54608912356322692, 0.31601366799853015],
[0.179325, 0.54992488086906433, 0.31975542953013203],
[0.18499467382503876, 0.55375090643485248, 0.32354045133316245],
[0.19071669933199040, 0.55756719645853980, 0.32736880086784997],
[0.196489, 0.56137375378171828, 0.33124052700923262],
[0.20231149476194071, 0.565171, 0.33515566024496213],
[0.20818140243070904, 0.56895771564496678, 0.33911421288458921],
[0.21409785767845713, 0.57273516017442738, 0.343116],
[0.22006, 0.57650295220940151, 0.34716153605451888],
[0.22606539826117472, 0.580261, 0.35125],
[0.23211411019408734, 0.58400973743728768, 0.35538224005249164],
[0.23820461348098621, 0.58774882836101439, 0.359557],
[0.24433583395819886, 0.59147846244608571, 0.36377579267474364],
[0.250507, 0.59519870739716885, 0.36803714756150335],
[0.25671631699724051, 0.59890963861360547, 0.37234139436127461],
[0.26296360893465709, 0.60261133927039723, 0.376688],
[0.26924767122710141, 0.60630390039431148, 0.38107798707203944],
[0.27556759059359787, 0.60998742093498581, 0.38551],
[0.281922, 0.61366200783091807, 0.38998426360326915],
[0.28831146901961924, 0.61732777607022094, 0.39450055905128784],
[0.29473371750616867, 0.62098484874605098, 0.399059],
[0.30118839861544255, 0.62463335710659262, 0.40365838923592778],
[0.30767470510377343, 0.62827344059950441, 0.40829945208475604],
[0.31419184652113580, 0.63190524691073913, 0.41298160968985576],
[0.32073904807434278, 0.63552893199763771, 0.41770459287283251],
[0.32731554960672499, 0.639145, 0.42246811976666177],
[0.33392060468330909, 0.64275260384264243, 0.42727189615758349],
[0.34055347977154449, 0.64635294408858657, 0.43211561583034058],
[0.34721345350858374, 0.64994587011080274, 0.43699896091654711],
[0.35389981604704379, 0.65353157951446617, 0.44192160224598254],
[0.36061186847193116, 0.65711027825047230, 0.44688319970061236],
[0.36734892228210081, 0.660682, 0.45188340257113152],
[0.37411029893025216, 0.664248, 0.45692184991583568],
[0.38089532941602544, 0.667806, 0.46199817092162015],
[0.38770335392725391, 0.67135937696642711, 0.46711198526690772],
[0.394534, 0.67490640276070180, 0.47226290348629890],
[0.40138578986759954, 0.67844782792294167, 0.47745052733674181],
[0.40825892497196359, 0.681984, 0.48267445016500415],
[0.41515250100546647, 0.68551493955568776, 0.48793425727623324],
[0.42206590010856632, 0.68904117782330965, 0.49322952630337596],
[0.42899851224334989, 0.69256291893042576, 0.49855982757722411],
[0.43594973506605239, 0.69608045868390644, 0.50392472449684578],
[0.44291897382100109, 0.69959410072256278, 0.50932377390014849],
[0.449906, 0.70310415643504154, 0.514757],
[0.45690915754179889, 0.706611, 0.52022252692582882],
[0.46392895023962172, 0.71011479265268618, 0.52572131474983519],
[0.47096445423853978, 0.71361603386605454, 0.53125242419849394],
[0.47801511173750716, 0.71711500996655897, 0.53681538484806579],
[0.48508037222468575, 0.72061206966479452, 0.54241],
[0.49215969246791263, 0.72410756881315075, 0.54803495666636792],
[0.49925253651277707, 0.72760187028668843, 0.55369060668729642],
[0.50635837568708231, 0.73109534385942676, 0.55937618633336805],
[0.51347668861049389, 0.73458836607628064, 0.56509120703928817],
[0.52060696120824201, 0.73808132012088667, 0.57083517768042247],
[0.52774868672784692, 0.74157459567956729, 0.57660760492113561],
[0.53490136575780645, 0.74506858880172711, 0.58240799355889361],
[0.54206450624729385, 0.74856370175696663, 0.58823584686368524],
[0.54923762352594052, 0.75206034288922063, 0.59409066691231349],
[0.55642024032272597, 0.75555892646828315, 0.59997195491708100],
[0.56361188678316410, 0.75905987253904272, 0.60587921154836910],
[0.57081210048385067, 0.76256360676883461, 0.61181193725060567],
[0.57802042644352103, 0.76607056029329656, 0.61776963255106987],
[0.58523641712976515, 0.76958116956115996, 0.62375179836098060],
[0.59245963246052524, 0.77309587617843167, 0.62975793626826826],
[0.59969, 0.776615, 0.63578754882141286],
[0.60692601394455059, 0.78013937273630862, 0.64184],
[0.61416833710821017, 0.78366907027425470, 0.64791521449709877],
[0.62141619888933408, 0.78720468004853827, 0.65401227993534916],
[0.62866919623487128, 0.790747, 0.66013084514491793],
[0.63592693339073703, 0.79429550082212108, 0.66627042137354608],
[0.64318902184066229, 0.797852, 0.67243052230513944],
[0.65045508023176912, 0.80141560561384795, 0.67861066426014516],
[0.65772473428568712, 0.80498783524266682, 0.68481],
[0.664998, 0.808569, 0.69102915079691085],
[0.67227336699418649, 0.81215907316347957, 0.69726654278044797],
[0.67955163143155639, 0.81575906177001112, 0.70352207087167495],
[0.68683206279314624, 0.81936928933323216, 0.70979526699116413],
[0.69411432022368014, 0.82299025433775164, 0.71608566652646277],
[0.70139806901382373, 0.82662245843880333, 0.72239280839468223],
[0.70868298036059418, 0.83026640639312355, 0.72871623507840821],
[0.71596873109646730, 0.83392260600509183, 0.73505549263251713],
[0.72325500338373205, 0.83759156809008139, 0.74141013065915307],
[0.73054148437014588, 0.84127380645726124, 0.74777970224772705],
[0.73782786580127146, 0.84496983791436953, 0.75416376387634965],
[0.74511384358425525, 0.84868018229733078, 0.76056187527055730],
[0.75239911729682551, 0.85240536252804422, 0.76697359921452801],
[0.75968338963437987, 0.85614590470413055, 0.77339850130920751],
[0.76696636578671207, 0.85990233822507411, 0.77983614967080173],
[0.77424775273437663, 0.86367519595993791, 0.78628611456193898],
[0.78152725845297755, 0.86746501446270252, 0.79274796794640856],
[0.78880459101123401, 0.87127233424243156, 0.79922128295662909],
[0.79607945754602039, 0.87509770009678767, 0.80570563326089961],
[0.80335156309405842, 0.87894166151913877, 0.81220059231482378],
[0.81062060925560697, 0.88280477319159978, 0.81870573247800949],
[0.81788629266008372, 0.88668759557900512, 0.82522062397299201],
[0.82514830319665822, 0.89059069564216009, 0.831745],
[0.83240632196402842, 0.89451464769302769, 0.83827792357905861],
[0.83966001888224673, 0.89846003442003164, 0.84481944925616603],
[0.84690904989468208, 0.90242744811883613, 0.85136895765121290],
[0.85415305366871019, 0.90641749217346990, 0.85792598474522230],
[0.86139164767790399, 0.91043078284518275, 0.86449005263698520],
[0.868624, 0.91446795144340653, 0.87106066604650678],
[0.87585094122577745, 0.91852964697626083, 0.87763730807106488],
[0.88307072242862483, 0.92261653941002220, 0.88421943499143241],
[0.890283, 0.92672932371194672, 0.89080646985522782],
[0.89748791655833893, 0.93086872491525774, 0.89739779446320900],
[0.90468409300945218, 0.93503550453923912, 0.90399273923646750],
[0.91187102955312593, 0.93923046883796835, 0.91059057022150136],
[0.91904787435856306, 0.94345447956676232, 0.91719047215132521],
[0.92621363580001581, 0.94770846829521538, 0.92379152594629965],
[0.93336714230032736, 0.95199345584963047, 0.93039267816674998],
[0.94050698636428409, 0.95631057940576525, 0.93699269845266431],
[0.94763144411511890, 0.96066113141499210, 0.94359011836795115],
[0.95473835517387229, 0.96504661765544741, 0.95018314016903005],
[0.96182493477714048, 0.96946884790871157, 0.95676949423002078],
[0.96888746192056285, 0.97393, 0.96334620261618131],
[0.97592071939347969, 0.97843332029895069, 0.96990915500139263],
[0.982917, 0.98298280006992089, 0.97645225985354356],
[0.98986281013230182, 0.98758530979862858, 0.98296543820958482],
[0.99673171614908396, 0.99225420046161139, 0.98942825746633545],
[1, 0.99704378266210936, 0.99575555752072120]]

test_cm = LinearSegmentedColormap.from_list(__file__, cm_data)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from pycam02ucs.cm.viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("pycam02ucs not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
