from matplotlib.colors import LinearSegmentedColormap
from numpy import nan, inf
cm_data = [[0.000019872508023912684, 0.000019586801788918958, 0.000019529289536969018],
[0.00039665790922951749, 0.00032638571767466080, 0.00027492311664304895],
[0.0011869002314108953, 0.000921163, 0.00072976007761940210],
[0.0023702943776980961, 0.0017630648837132961, 0.0013327346580250460],
[0.0039418921929231946, 0.0028300365723437676, 0.0020540241542560535],
[0.0059016563340814681, 0.0041070928575312159, 0.0028725398349458424],
[0.0082518868587975226, 0.0055829837261848567, 0.0037720137250076844],
[0.0109962, 0.0072487602748392962, 0.0047392505027576562],
[0.014139046251892341, 0.0090970274202933302, 0.0057631911880601959],
[0.017685408630991661, 0.011121506563816348, 0.0068343527475475509],
[0.021640665400503752, 0.013316758555822514, 0.0079444661829361982],
[0.026010469861575122, 0.015677997782589718, 0.0090862294000495676],
[0.030800681077196263, 0.018200961801821580, 0.010253131074773696],
[0.036017312867084796, 0.020881816722323435, 0.011439320776812948],
[0.0416357, 0.023717086598802603, 0.012639510507680586],
[0.047285841179287434, 0.026703599542067993, 0.013848898306740541],
[0.052899118419477635, 0.0298384, 0.015063107802584170],
[0.058479799008006657, 0.033118944720699400, 0.016278139563383982],
[0.064031535636710213, 0.036542618147086106, 0.0174903],
[0.0695575, 0.040107169120448177, 0.018696325266118152],
[0.075060406260969548, 0.043677283605224222, 0.019893040136012719],
[0.0805427, 0.047193027000334321, 0.021077648272409960],
[0.086006483825610686, 0.050662241526896114, 0.022247555514309760],
[0.0914536, 0.054087596534574532, 0.023400384056865960],
[0.096885802692860484, 0.057471518546517240, 0.024533957517538205],
[0.10230446989089512, 0.0608162, 0.025646287853965163],
[0.10771094828816064, 0.064123749678705655, 0.026735563822338798],
[0.11310641186963694, 0.067395970539849304, 0.027800140727191044],
[0.11849191079021870, 0.070634624798490864, 0.028838531261560572],
[0.123868, 0.073841327927684885, 0.029849397274067182],
[0.12923667863145186, 0.077017587503493856, 0.030831542329068779],
[0.13459754556710171, 0.080164815509782106, 0.031783904949690689],
[0.139952, 0.083284338979296463, 0.032705552452485957],
[0.14529963705048871, 0.086377409240040837, 0.033595675297842249],
[0.15064200935475230, 0.089445209985526380, 0.034453581892770306],
[0.15597926350105601, 0.0924889, 0.035278693792995065],
[0.16131182987823914, 0.095509441119722066, 0.036070541259761751],
[0.16664009026350984, 0.098507960250437399, 0.036828759133833634],
[0.17196438182958199, 0.10148539771198695, 0.037553082995060695],
[0.17728500070223879, 0.10444268982543858, 0.038243345580856743],
[0.18260220512948946, 0.10738073711582316, 0.038899473441111373],
[0.18791621831387398, 0.1103, 0.039521483810615016],
[0.19322723095157049, 0.113203, 0.040109481683099017],
[0.19853540351542087, 0.11608794822781487, 0.040659717324393420],
[0.20384086831357051, 0.11895741887906974, 0.041168137595335615],
[0.20914373135087078, 0.12181171926132059, 0.0416408],
[0.21444407401641335, 0.12465159629446448, 0.042078695827671868],
[0.21974195461735369, 0.12747777899973134, 0.042483101442228895],
[0.22503740977648767, 0.130291, 0.042855095842373424],
[0.23033045570875321, 0.13309189781141720, 0.043195806700556928],
[0.23562108938987614, 0.13588121662622593, 0.043506364907026023],
[0.24090928962871300, 0.13865960912689770, 0.043787907636248215],
[0.24619501805342592, 0.14142773681729714, 0.044041581381096102],
[0.25147822002038123, 0.14418625119730691, 0.044268544969171368],
[0.25675882545362083, 0.14693579468502191, 0.044469972573550932],
[0.26203674962183671, 0.14967700145269550, 0.0446471],
[0.26731189385897664, 0.15241049818380401, 0.044801011356050975],
[0.27258414623393551, 0.15513690475776251, 0.044933074816226805],
[0.27785338217417743, 0.15785683486812860, 0.045044512973437943],
[0.28311946504760455, 0.16057089657950746, 0.045136622291725832],
[0.28838224670654416, 0.16327969282782409, 0.0452107],
[0.29364156799730701, 0.16598382186816285, 0.045268211982224756],
[0.29889725923842159, 0.168684, 0.045310466415351018],
[0.30414914067034587, 0.17138045029089866, 0.045338946427865325],
[0.30939702287916332, 0.17407412614878584, 0.045355148481831912],
[0.31464070719654447, 0.176765, 0.045360618430406348],
[0.31988, 0.17945511682471685, 0.045356954571944406],
[0.32511464346149171, 0.18214358869304237, 0.045345810624756240],
[0.33034445510750426, 0.184831, 0.045328898590634971],
[0.33556918892310789, 0.18751935729932717, 0.045307991470036217],
[0.34078860527043381, 0.19020779501783011, 0.045284925786304671],
[0.346002, 0.19289735826811633, 0.045261603870748242],
[0.35121049104000313, 0.19558861154169704, 0.045239995854731187],
[0.35641244605227146, 0.198282, 0.045222141309495929],
[0.36160805530657836, 0.20097843456597331, 0.045210150469281722],
[0.36679704562353233, 0.20367812175448530, 0.045206204968754986],
[0.37197913787731551, 0.20638173380278768, 0.045212558022057848],
[0.37715404722891366, 0.20908982354212824, 0.045231533968247938],
[0.38232148335202232, 0.21180294134763605, 0.045265527106890503],
[0.38748115065229988, 0.21452163505550992, 0.045317],
[0.39263274848060597, 0.21724644986450087, 0.045388479407210906],
[0.397776, 0.21997792822264622, 0.0454826],
[0.402911, 0.22271660970017609, 0.045601872487079760],
[0.40803604715078501, 0.22546303084948410, 0.045749128427238626],
[0.41315226667852328, 0.22821772505301941, 0.045927063888666735],
[0.41825884478014325, 0.23098122235994584, 0.046138456233329218],
[0.42335545468870817, 0.23375404931238286, 0.046386110269635510],
[0.42844176595193611, 0.236537, 0.046672848316471498],
[0.43351744461577824, 0.23932977967792202, 0.047001499314746752],
[0.438582, 0.24213371694619035, 0.047374887081856963],
[0.44363555190947279, 0.24494905116239657, 0.047795817835057340],
[0.44867729675137463, 0.24777628841735738, 0.048267067139826224],
[0.45370704177553606, 0.25061593007708116, 0.048791366467459373],
[0.45872443822129788, 0.253468, 0.049371389570911035],
[0.46372913490134599, 0.25633440709515637, 0.050009738907758901],
[0.46872077837938547, 0.25921421951312523, 0.0507089],
[0.47369901314814472, 0.262108, 0.051471390448415290],
[0.47866348180794443, 0.265017, 0.0522994],
[0.48361382524607205, 0.26794169610414537, 0.053195225331349537],
[0.48854968281721173, 0.27088176169286016, 0.0541609],
[0.49347069252512837, 0.27383804473559170, 0.055198233775657919],
[0.49837649120583222, 0.27681099355006666, 0.056309142000665620],
[0.50326671471242535, 0.27980104935784200, 0.057495206732005123],
[0.50814099810182389, 0.28280864604444267, 0.058757902607425728],
[0.512999, 0.28583420992145708, 0.060098549522478721],
[0.51784028191068277, 0.28887815949116941, 0.061518312884664146],
[0.52266455017341595, 0.29194090521427657, 0.063018205548540124],
[0.52747141439490897, 0.29502284928124489, 0.064599091323615548],
[0.53226050853005902, 0.29812438538782354, 0.066261689913204719],
[0.53703146690704995, 0.30124589851523265, 0.068006583115613722],
[0.54178392443190471, 0.30438776471551843, 0.069834222099643878],
[0.54651751679616001, 0.30755035090255334, 0.071744935554700628],
[0.551232, 0.31073401464914224, 0.073738938511457519],
[0.55592665400536267, 0.31393910399067387, 0.075816341631545242],
[0.56060147607592226, 0.31716595723574276, 0.077977160773170684],
[0.56525598787601605, 0.32041490278414714, 0.080221326652930247],
[0.56988983225662759, 0.32368625895264230, 0.082548694441176323],
[0.57450265417167246, 0.32698, 0.0849591],
[0.579094, 0.330297, 0.087452134677983628],
[0.58366382233272696, 0.33363781967161010, 0.0900276],
[0.58821147111057226, 0.33700179419295384, 0.092685159530303624],
[0.59273670297017023, 0.34038961416127422, 0.0954244],
[0.59723917694043860, 0.34380153421378207, 0.098244796624457481],
[0.60171855560437881, 0.34723779793023230, 0.10114604575381969],
[0.60617450535451733, 0.35069863773215631, 0.10412765438033575],
[0.61060669665222900, 0.35418427479239845, 0.10718916447805077],
[0.61501480429093114, 0.35769491895512612, 0.11033011355448549],
[0.619399, 0.361231, 0.11355003846711875],
[0.62375749103103872, 0.36479201091601476, 0.11684847867275708],
[0.628091, 0.36837882118897952, 0.12022497894387762],
[0.63240006080359790, 0.37199136342965994, 0.12367909158912818],
[0.63668304257097519, 0.37562979001572922, 0.12721],
[0.64094009562662790, 0.37929424174374599, 0.13081841108205050],
[0.64517093277168935, 0.38298484782580933, 0.13450277405404615],
[0.64937527337722967, 0.38670172589739926, 0.13826306324710661],
[0.65355284367922384, 0.39044498203639355, 0.14209888734748918],
[0.65770337707647652, 0.39421471079326020, 0.14600986767441434],
[0.661827, 0.39801099523237499, 0.14999563800743496],
[0.665922, 0.40183390698442512, 0.15405584421122168],
[0.66999020360456452, 0.40568350630982281, 0.15819014368634371],
[0.67403007720832819, 0.40955984217305186, 0.16239820467222085],
[0.678042, 0.41346295232783570, 0.16667970542611604],
[0.68202485163453452, 0.41739286341302839, 0.17103433329975012],
[0.68597932732933864, 0.42134959105907765, 0.17546178373297547],
[0.68990492777010426, 0.42533314000493278, 0.17996175918191554],
[0.69380146463156866, 0.42934350422522299, 0.18453396799706989],
[0.69766875985358845, 0.43338066706754974, 0.18917812326513506],
[0.701507, 0.43744460139968566, 0.193894],
[0.70531496637006186, 0.441535, 0.19868114208040927],
[0.70909357572909693, 0.44565262455640803, 0.20353944478314523],
[0.71284234021318649, 0.44979660817704564, 0.20846856985403778],
[0.71656113785242115, 0.45396715324007592, 0.21346823618969668],
[0.72024985884548942, 0.45816418275473508, 0.21853816029657380],
[0.72390840587422811, 0.46238761032994707, 0.22367805514577294],
[0.72753669441649515, 0.46663734038471211, 0.22888762905477983],
[0.731135, 0.47091326836649144, 0.23416658459994072],
[0.73470222379595163, 0.47521528097730742, 0.23951461756290560],
[0.73823936235440779, 0.47954325640725065, 0.24493141591375833],
[0.74174603847723441, 0.48389706457509890, 0.25041665883306485],
[0.745222, 0.48827656737572295, 0.25597001577471140],
[0.74866795430418453, 0.49268161893396550, 0.26159114557101804],
[0.75208320628810632, 0.49711206586465079, 0.26727969558133807],
[0.75546802097313182, 0.50156774753839128, 0.27303530088506844],
[0.75882244262485066, 0.50604849635284810, 0.27885758351976692],
[0.76214653126078369, 0.51055413800908234, 0.28474615176488299],
[0.76544036292025197, 0.51508449179263782, 0.29070059947141402],
[0.768704, 0.51963937085900314, 0.29672050543765177],
[0.77193764115112340, 0.52421858252305553, 0.30280543283105543],
[0.77514132224918075, 0.52882192855213084, 0.30895492865614821],
[0.778315, 0.53344920546231556, 0.31516852326825162],
[0.781459, 0.53810020481759579, 0.32144572993275911],
[0.784574, 0.54277471353144746, 0.32778604442957215],
[0.78765985967836705, 0.54747251417048470, 0.33418894470224730],
[0.79071637931243743, 0.55219338525976036, 0.34065389055133127],
[0.79374408843879030, 0.55693710158932486, 0.34718032337128790],
[0.79674323659549751, 0.56170343452161620, 0.35376766593037895],
[0.79971409181615993, 0.56649215229930150, 0.36041532219277994],
[0.80265694080059680, 0.57130302035313207, 0.36712267718217822],
[0.80557208907513833, 0.57613580160942501, 0.37388909688603361],
[0.80845986114225921, 0.58099, 0.380714],
[0.81132060061931566, 0.58586614475134125, 0.38759649890906384],
[0.81415467036616662, 0.59076322272106851, 0.39453611771200819],
[0.81696245260147993, 0.59568124666713251, 0.40153207427556148],
[0.81974434900758619, 0.60061997156349201, 0.40858363932978459],
[0.822501, 0.60557915169337351, 0.41569006479600629],
[0.825232, 0.61055854094252571, 0.42285058394865527],
[0.82793903390433477, 0.61555789308880848, 0.430064],
[0.83062179610618947, 0.62057696208771029, 0.43733074437236025],
[0.83328097569656212, 0.62561550235339736, 0.44464876085891897],
[0.83591709268527936, 0.630673, 0.45201762200096324],
[0.83853068695088362, 0.63575001828696742, 0.45943647135087856],
[0.84112231825152806, 0.640846, 0.466904],
[0.84369256622447930, 0.64595949573639433, 0.47442062402225588],
[0.84624203037441426, 0.65109174362887978, 0.48198413068627716],
[0.84877133005084127, 0.65624201398098914, 0.48959403302605103],
[0.85128110441495197, 0.66141007182859002, 0.49724939317651778],
[0.853772, 0.66659568470653407, 0.50494925822731518],
[0.85624473264034096, 0.67179862287192815, 0.51269266067433905],
[0.85869996344562838, 0.67701865951906581, 0.52047861888398350],
[0.86113842269436536, 0.68225557098565681, 0.52830613756789546],
[0.86356084777399589, 0.68750913694997828, 0.53617420826599327],
[0.86596799549255510, 0.69277914061855594, 0.54408180983536669],
[0.86836064198812812, 0.69806536890398285, 0.55202790894256126],
[0.87073958263360884, 0.70336761259249048, 0.56001146055660156],
[0.87310563193798918, 0.70868566650085152, 0.56803140843996769],
[0.87546, 0.71401932962218750, 0.57608668563454768],
[0.87780240963485456, 0.71936840526025270, 0.58417621493941641],
[0.88013486181823208, 0.72473270115170796, 0.59229890937707030],
[0.88245787004555209, 0.73011202957590771, 0.60045367264448879],
[0.88477234301269514, 0.73550620745165018, 0.60863939954514246],
[0.88707920797831086, 0.74091505642032396, 0.61685497639772524],
[0.88937941069132820, 0.74633840291481879, 0.62509928141703353],
[0.89167391533245211, 0.75177607821350456, 0.63337118506200096],
[0.89396370447325402, 0.75722791847849880, 0.64167],
[0.89625, 0.76269376477736761, 0.64999323309909285],
[0.89853315840534487, 0.76817346308726198, 0.65834108218832443],
[0.90081488025775724, 0.773667, 0.666712],
[0.903096, 0.77917382408953695, 0.67510464086719768],
[0.905378, 0.78469420305213677, 0.68351801440927706],
[0.90766075641410859, 0.79022786643122955, 0.69195088212834110],
[0.90994659768592345, 0.79577468411125540, 0.70040205889818319],
[0.91223625082576731, 0.80133453046637004, 0.70887035234238693],
[0.91453086754699930, 0.80690728419850588, 0.71735456241480688],
[0.91683161977916716, 0.81249282814191792, 0.72585348083041967],
[0.91913970027741931, 0.81809104903028473, 0.73436589032403143],
[0.92145632336929384, 0.82370183722173484, 0.74289056371025686],
[0.92378272586331667, 0.82932508637613644, 0.75142626271317892],
[0.92612016814855402, 0.83496069307788245, 0.75997173652787087],
[0.92846993552040735, 0.84060855639586496, 0.76852572006821485],
[0.930833, 0.84626857737052408, 0.777087],
[0.93321172112732043, 0.85194065841544098, 0.78565407141123778],
[0.93560645050928581, 0.85762470261798063, 0.79422581627725997],
[0.93801893234187128, 0.86332061291955398, 0.80280081821487426],
[0.94045060786795886, 0.86902829115101976, 0.81137769879699373],
[0.94290295918164713, 0.87474763689205837, 0.81995504402135522],
[0.945378, 0.88047854611448340, 0.82853139780204033],
[0.94787585218680281, 0.88622090955746768, 0.83710525405539937],
[0.95039961190871247, 0.89197461076637041, 0.84567504702116692],
[0.95295049978189261, 0.89773952370417320, 0.854239],
[0.95553030150930274, 0.90351550981272388, 0.86279580725636340],
[0.95814089607752562, 0.90930241435529535, 0.87134322203077541],
[0.96078427365275598, 0.91510006180519121, 0.87987942639306371],
[0.96346255862286967, 0.92090824994528164, 0.88840230423118660],
[0.96617803972312710, 0.92672674219017148, 0.89690954101005027],
[0.96893321013583045, 0.93255525740096445, 0.90539857111378685],
[0.97173082200609195, 0.93839345606818037, 0.91386650627500998],
[0.97457396244227590, 0.94424092106978630, 0.92231],
[0.97746616271952902, 0.95009713002562701, 0.93072528309938407],
[0.98041156109451111, 0.955961, 0.93910759179531023],
[0.98341515698326754, 0.96183289326667321, 0.94745119129846589],
[0.986483, 0.96771036981555791, 0.95574864261942671],
[0.989624, 0.973592, 0.96398984471499472],
[0.99284962802984056, 0.97947558856917405, 0.97216],
[0.99617875648475362, 0.985356, 0.98023515403582640],
[0.99964876423679872, 0.99122522822422210, 0.98816684126571441],
[1, 0.99704378266210936, 0.99575555752072120]]

test_cm = LinearSegmentedColormap.from_list(__file__, cm_data)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from pycam02ucs.cm.viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("pycam02ucs not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
