from matplotlib.colors import LinearSegmentedColormap
from numpy import nan, inf
cm_data = [[0.000019872508023912684, 0.000019586801788918958, 0.000019529289536969018],
[0.00029732998421491962, 0.00035867504961416703, 0.00034007895731285465],
[0.00080335037005509625, 0.0010461146062275824, 0.00097770438825407389],
[0.0014842685411257986, 0.0020520177088559901, 0.0019007909413748167],
[0.0023074274882280105, 0.0033633702515901047, 0.0030964146613915106],
[0.0032485105135635303, 0.0049730415552687261, 0.0045588551825214360],
[0.0042877517380054859, 0.0068768549551660504, 0.0062863909392459312],
[0.0054082672210925605, 0.00907237, 0.0082799307128804626],
[0.0065951732261183499, 0.011558261022320949, 0.010542305162631528],
[0.0078350665747987207, 0.014333965233700032, 0.013077855143731143],
[0.0091156953055529163, 0.017399455345446555, 0.015892173266841177],
[0.010425739049943495, 0.020755092586325206, 0.018991932498228711],
[0.011754657166536295, 0.024401521436324625, 0.022384767786907102],
[0.013092581014247448, 0.028339592737324781, 0.026079191771098759],
[0.014430236240612976, 0.0325703, 0.030084533319250525],
[0.0157589, 0.037094759808898488, 0.034410891880491838],
[0.017070290815870560, 0.041874595653282491, 0.039069103063127553],
[0.018356676633086919, 0.046636044884174936, 0.0439211],
[0.019610715889207472, 0.051355695600008862, 0.048764391996423871],
[0.020825512100236941, 0.056036798620090387, 0.053613208911926939],
[0.0219946, 0.060682159460033740, 0.058471898100156065],
[0.023111896177034207, 0.065294208503536788, 0.063344381882859124],
[0.024171787078212093, 0.069875057073110092, 0.068234217651011397],
[0.025169041330053179, 0.074426542742648066, 0.073144645511413836],
[0.026098858318642636, 0.0789503, 0.078078627066758249],
[0.026956865182130765, 0.083447622412925249, 0.083038877231362190],
[0.027739124385951473, 0.087919824636744109, 0.088027890516302831],
[0.028442142694167210, 0.092367927008497552, 0.093047962878168106],
[0.029062881319063042, 0.096792841819664382, 0.098101209976176801],
[0.029598767063418074, 0.10119535491391640, 0.10319],
[0.0300477, 0.10557613875754210, 0.10831487906504644],
[0.030408087610021450, 0.10993576370497515, 0.113479],
[0.030678815064117890, 0.11427470776976176, 0.11868274233664206],
[0.030859301846884794, 0.11859336515117841, 0.12392823610774328],
[0.030949494302281212, 0.122892, 0.12921652256193358],
[0.030949884189996148, 0.12717102162774527, 0.13454877403903084],
[0.030861523094939287, 0.13143045318188273, 0.13992605592580851],
[0.030686036893859198, 0.13567047409089727, 0.14534933072394449],
[0.030425640191141627, 0.13989115618304621, 0.15081946148955089],
[0.030083150637842466, 0.14409252167221773, 0.15633721473159795],
[0.029662, 0.14827454703934254, 0.16190326284340573],
[0.029166263238291346, 0.15243716658538928, 0.16751818613064848],
[0.028600641478838396, 0.15658027570378422, 0.173182],
[0.027970505520874173, 0.16070373391306744, 0.17889652878923498],
[0.027281893070171603, 0.16480736768473597, 0.18466066197972703],
[0.026541523652742122, 0.16889097309630799, 0.19047509999498108],
[0.025756809780626298, 0.17295431833549182, 0.19633998245003392],
[0.024935867336734151, 0.17699714607782621, 0.20225536318076204],
[0.024087525096528992, 0.18101917575715357, 0.20822121064535609],
[0.023221333304674158, 0.18502010574571664, 0.21423740821170156],
[0.022347571225313095, 0.189, 0.22030375435182586],
[0.021477253585397149, 0.19295736739405434, 0.22641996276279747],
[0.020622135831530188, 0.19689300912395569, 0.23258566243196144],
[0.019794718122129788, 0.20080617523837085, 0.23880039766309374],
[0.019008247978390479, 0.20469648925788608, 0.24506362807896115],
[0.018276721519574157, 0.20856356551739019, 0.25137472861480226],
[0.017614883210541613, 0.21240701102835685, 0.25773298951641699],
[0.017038224052372344, 0.21622642732445729, 0.26413761635580651],
[0.016562978150091213, 0.22002141229464200, 0.27058773007666165],
[0.016206117595285077, 0.22379156200702793, 0.27708236708139100],
[0.015985345605572444, 0.22753647252620968, 0.28362047937085910],
[0.015919087867503852, 0.23125574172592750, 0.29020093474748310],
[0.016026482034580625, 0.23494897109840301, 0.29682251709188257],
[0.016327365337685033, 0.23861576756105385, 0.303484],
[0.016842260271220880, 0.24225574526074528, 0.310184],
[0.017592358324739814, 0.24586852737521103, 0.31692061412618794],
[0.018599501736877164, 0.24945374791076441, 0.323693],
[0.019886163255600903, 0.25301105349496228, 0.33049894806677405],
[0.021475423896699187, 0.25654010516241477, 0.33733711183083004],
[0.023390948700475107, 0.26004058013151243, 0.34420558289046532],
[0.025657, 0.26351217356943396, 0.35110249554252959],
[0.028298211683572980, 0.26695460034240076, 0.35802590741961438],
[0.031339954081359395, 0.27036759674778837, 0.36497380096282894],
[0.034807906838661293, 0.27375092222435021, 0.37194408504969151],
[0.038728222493552782, 0.27710436103649372, 0.37893459678142694],
[0.043033345982980538, 0.28042772392824278, 0.38594310343334170],
[0.047533572079957544, 0.28372084974225598, 0.392967],
[0.052219650233074351, 0.28698360699900943, 0.40000483433660250],
[0.057076622837698439, 0.29021589543104709, 0.40705326390107210],
[0.0620911, 0.293418, 0.41411010409299409],
[0.067251190305618463, 0.29658882965993649, 0.42117280819435937],
[0.072546232885347228, 0.29972944405442092, 0.42823877490865209],
[0.077966769634950917, 0.30283952948669268, 0.435305],
[0.083504341849168329, 0.30591916281216408, 0.44236983708645050],
[0.089151370652537865, 0.308968, 0.44942948612951367],
[0.094901038465781434, 0.31198757747089007, 0.45648151204091864],
[0.10074718413137088, 0.314977, 0.46352309097716832],
[0.10668421123791216, 0.31793610477684731, 0.47055136577128026],
[0.11270700866793967, 0.320866, 0.47756345001046291],
[0.11881088216031760, 0.32376683408995782, 0.48455643225047135],
[0.12499149561680012, 0.32663886718551999, 0.49152738035873472],
[0.131245, 0.32948255055011683, 0.498473],
[0.137567, 0.33229834368346428, 0.50539136909802418],
[0.14395478397245703, 0.33508675116881692, 0.51227848273423349],
[0.15040455088451982, 0.33784832274987464, 0.51913171768734723],
[0.15691323054366252, 0.34058365327751894, 0.52594810738759812],
[0.16347780647990165, 0.34329338252385183, 0.53272469280235724],
[0.17009539201806159, 0.34597819486156744, 0.53945852739750533],
[0.17676321410648060, 0.34863881880726466, 0.54614668213895823],
[0.18347859959865492, 0.35127602642793226, 0.55278625052071872],
[0.19023896362587353, 0.35389063261048320, 0.55937435360545973],
[0.19704179975319969, 0.35648349419489161, 0.56590814506332321],
[0.20388467165722501, 0.35905550897217542, 0.57238481619437842],
[0.21076520610311611, 0.36160761454919083, 0.57880160092000277],
[0.21768108703151801, 0.36414078708290626, 0.58515578072836205],
[0.22463005059372121, 0.36665603988757672, 0.59144468955912877],
[0.23160988099715663, 0.36915442191894360, 0.59766571861265339],
[0.23861840704313753, 0.37163701614031580, 0.60381632106891436],
[0.24565349925566304, 0.37410493777609405, 0.60989401670180510],
[0.25271306751434969, 0.37655933245898438, 0.61589639637459614],
[0.259795, 0.37900137427780256, 0.62182112640277243],
[0.26689745720527980, 0.38143226373340672, 0.62766595277089920],
[0.274018, 0.38385322561087948, 0.63342870519067407],
[0.28115557731462826, 0.38626550677660865, 0.63910730098790436],
[0.28830743473471870, 0.38867037390943321, 0.6447],
[0.29547196805533799, 0.39106911117542009, 0.65020415212069760],
[0.30264732531273719, 0.39346301785623000, 0.655619],
[0.30983168596325661, 0.39585340594132196, 0.66094173290135161],
[0.31702326065889347, 0.398242, 0.66617162014973508],
[0.32422029110276812, 0.40062892320527454, 0.67130688797232285],
[0.33142104996665894, 0.40301671793624483, 0.67634615921112817],
[0.33862384085513136, 0.40540632027639334, 0.68128816802864001],
[0.34582699830294367, 0.40779906911174552, 0.686132],
[0.35302888779425223, 0.41019630142337321, 0.69087590292682088],
[0.360228, 0.41259934992313080, 0.69551966997098014],
[0.36742247978177767, 0.41500954073701690, 0.70006225910521513],
[0.37461106828517465, 0.41742819114568064, 0.70450298488152618],
[0.38179216089997597, 0.41985660739112596, 0.70884128091686127],
[0.38896427829911778, 0.42229608255814571, 0.71307670029782222],
[0.39612597222241663, 0.42474789453842138, 0.71720891573529222],
[0.40327582544534007, 0.42721330408457559, 0.72123771947230630],
[0.41041245172424334, 0.42969355296078454, 0.72516302294938750],
[0.41753449571637996, 0.43218986219580641, 0.72898485623243148],
[0.424641, 0.43470343044352133, 0.73270336720904805],
[0.43172956930876161, 0.43723543245529106, 0.73631882056003539],
[0.43880004163578112, 0.43978701766761774, 0.73983159651339714],
[0.44585081678175359, 0.44235930890778363, 0.74324218938896292],
[0.45288069177352669, 0.44495340121931270, 0.74655120594230018],
[0.45988849349853950, 0.44757036080829110, 0.74975936351714834],
[0.46687307844139919, 0.45021122411079700, 0.75286748801609338],
[0.47383333239753295, 0.45287699698088318, 0.75587651169964498],
[0.48076817016540868, 0.45556865399785312, 0.758787],
[0.48767653521904136, 0.45828713789082182, 0.76160150312991126],
[0.49455739936253368, 0.46103335907792215, 0.76431984518893015],
[0.50140976236856583, 0.46380819531686895, 0.76694382962626595],
[0.50823265160274378, 0.46661249146305200, 0.76947488222361293],
[0.51502512163579195, 0.46944705933079406, 0.77191451891817242],
[0.52178625384558563, 0.472313, 0.774264],
[0.52851515601099130, 0.47521009213382842, 0.77652604047307017],
[0.53521096189949735, 0.47814001558936575, 0.77870137972994757],
[0.54187283085056925, 0.48110312816964734, 0.78079220532011673],
[0.54849994735659768, 0.48410007765688195, 0.78280043605392691],
[0.55509152064329403, 0.48713147983319877, 0.784728],
[0.56164678425128312, 0.49019791891185355, 0.78657713763197745],
[0.56816499562057110, 0.49329994802558580, 0.78834978524442390],
[0.57464543567952708, 0.49643808976586873, 0.79004818464411786],
[0.58108740843987849, 0.49961283676686380, 0.79167457312948941],
[0.58749024059917254, 0.50282465232800377, 0.79323124136502610],
[0.59385328115204339, 0.50607397106929186, 0.79472052995979214],
[0.600176, 0.50936119961359105, 0.79614482607224513],
[0.606457, 0.51268671729041571, 0.79750656004889220],
[0.61269746970280325, 0.51605087685598128, 0.79880820210381132],
[0.61889526670871631, 0.51945400522456275, 0.80005225904561361],
[0.62505033870033155, 0.52289640420651584, 0.80124127105788168],
[0.63116216093258326, 0.52637835124859567, 0.80237780853864704],
[0.63723022857788270, 0.52990010017259481, 0.80346446900394952],
[0.64325405644596367, 0.53346188190859933, 0.804504],
[0.64923317872083963, 0.53706390521952751, 0.80549866644819357],
[0.65516714871541382, 0.54070635741395423, 0.80645150716594438],
[0.66105553864425126, 0.54438940504454270, 0.80736507266740798],
[0.66689793941495024, 0.54811319458974139, 0.80824205214572031],
[0.67269396043849328, 0.55187785311671611, 0.809085],
[0.67844322945893920, 0.55568348892380626, 0.80989705778508780],
[0.68414539240275296, 0.55953019216106348, 0.81068050275597925],
[0.68980011324808799, 0.56341803542773006, 0.81143819449007992],
[0.695407, 0.56734707434577369, 0.81217284810550849],
[0.70096597417139717, 0.57131734810881851, 0.81288717696491541],
[0.70647653157137103, 0.57532888000606819, 0.81358389056811231],
[0.711938, 0.57938167792100392, 0.814266],
[0.717352, 0.58347573480483317, 0.81493527865988347],
[0.72271558799266045, 0.58761102912484076, 0.81559533509003357],
[0.72803030384981238, 0.59178752528793766, 0.81624853653694951],
[0.73329553036677542, 0.59600517403984132, 0.81689754460869246],
[0.73851109150458694, 0.600264, 0.81754500620728931],
[0.743677, 0.60456366621591617, 0.81819355200707145],
[0.74879260303529904, 0.60890434608857369, 0.81884579500902621],
[0.75385829122939385, 0.61328585208478270, 0.81950432916864024],
[0.75887378992006738, 0.61770807182227005, 0.82017172809456917],
[0.76383901376810215, 0.62217088117738528, 0.82085054381533007],
[0.768754, 0.62667414453333847, 0.82154330561110411],
[0.77361838895332657, 0.63121771501030344, 0.82225251890763906],
[0.77843246366579721, 0.63580143467829053, 0.82298066422916494],
[0.78319611079640794, 0.64042513475369811, 0.82373019620717281],
[0.787909, 0.64508863578042563, 0.824504],
[0.79257218326724266, 0.64979174779639382, 0.82530310361299541],
[0.797185, 0.65453427048629187, 0.82613125063704385],
[0.80174693008003517, 0.65931599332132385, 0.82699032586715149],
[0.80625899774314336, 0.66413669568667477, 0.82788264133290690],
[0.81072100616739429, 0.66899614699737075, 0.82881047821656995],
[0.81513309114589194, 0.673894, 0.82977608616259668],
[0.81949541093127942, 0.67883032488268402, 0.83078168261732488],
[0.82380814675471559, 0.68380454132825108, 0.83182945219569959],
[0.82807150337732716, 0.68881648662015949, 0.83292154607199875],
[0.832286, 0.69386588169232743, 0.83406008139156451],
[0.83645101926087517, 0.69895243798854711, 0.83524714070062633],
[0.84056771113818896, 0.70407585750980828, 0.83648477139133737],
[0.84463609039990917, 0.709236, 0.837775],
[0.84865648896235823, 0.71443204723835163, 0.83912],
[0.85262926634369463, 0.71966417453308451, 0.84052102703629417],
[0.85655481048671100, 0.72493187925811942, 0.84198069529113684],
[0.86043353862894245, 0.73023481659018052, 0.84350062587411811],
[0.86426589822306477, 0.735573, 0.84508264410881817],
[0.86805236791089557, 0.74094496298508539, 0.84672853648063318],
[0.87179345855474488, 0.74635143552557537, 0.84844005010871337],
[0.87549, 0.75179166754546301, 0.85021889221019331],
[0.87914171388660389, 0.75726526709420161, 0.85206672955434504],
[0.88275007157662055, 0.76277183261704251, 0.85398518790426126],
[0.88631543876824437, 0.76831095285529449, 0.85597585144362864],
[0.88983850523972530, 0.77388220672497421, 0.85804026218607954],
[0.89332000067011952, 0.77948516317091299, 0.86017991936450222],
[0.89676069623408983, 0.78511938099281930, 0.86239627879753244],
[0.90016140631284702, 0.79078440863916244, 0.86469075223025049],
[0.90352299033492112, 0.79647978396398678, 0.86706470664583824],
[0.90684635476304443, 0.80220503394078713, 0.86951946354462595],
[0.91013245524635456, 0.80795967432649740, 0.87205629818652963],
[0.91338229896087086, 0.813743, 0.87467643879235213],
[0.91659694716585061, 0.81955513083568254, 0.87738106569876517],
[0.91977751800918617, 0.82539491848807844, 0.88017131046098374],
[0.92292518962218129, 0.83126203842582003, 0.88304825489612560],
[0.92604120355297714, 0.83715594284374817, 0.88601293005900483],
[0.929127, 0.84307606904274546, 0.889066],
[0.93218356511394307, 0.84902183837901757, 0.89220933627707555],
[0.935213, 0.85499265501555033, 0.89544286525627692],
[0.93821596167392007, 0.86098790443224837, 0.89876771810255751],
[0.94119482764830664, 0.86700695163947172, 0.90218465352060639],
[0.94415107076319171, 0.87304913902401615, 0.90569437117092377],
[0.947087, 0.87911378373546878, 0.90929750974455359],
[0.95000311301834028, 0.88520017449207899, 0.91299464479571557],
[0.952903, 0.89130756764539398, 0.91678628627967751],
[0.95578816204279737, 0.89743518228681263, 0.92067287572796541],
[0.95866119965645347, 0.90358219409880791, 0.92465478297216752],
[0.96152459154433456, 0.90974772753611421, 0.92873230229863690],
[0.96438110477864292, 0.91593084574655692, 0.932906],
[0.96723375580606208, 0.92213053737219530, 0.93717494823295522],
[0.97008585944223091, 0.92834569894693719, 0.94154023949311527],
[0.97294109480009194, 0.93457511091500378, 0.94600145690363580],
[0.97580359640716774, 0.94081740412268788, 0.95055842402479229],
[0.97867808416839319, 0.94707101155933982, 0.95521083856146405],
[0.98157005590423341, 0.95333409624005505, 0.95995825322906769],
[0.98448608625675693, 0.95960443836540665, 0.96480004893329718],
[0.98743431914899193, 0.96587924806743597, 0.96973539536390863],
[0.99042534541171079, 0.97215482943796838, 0.97476318939101836],
[0.99347394782022536, 0.97842590816781139, 0.97988195007318601],
[0.99660319732460734, 0.98468404322776182, 0.98508961474579337],
[0.99985735476274262, 0.99091259148594790, 0.99038304081082418],
[1, 0.99704378266210936, 0.99575555752072120]]

test_cm = LinearSegmentedColormap.from_list(__file__, cm_data)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from pycam02ucs.cm.viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("pycam02ucs not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
